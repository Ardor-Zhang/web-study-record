TLS握手实际上是在TCP握手之后进行的。这里是两种握手的基本顺序和它们的作用：

### TCP握手（三次握手）

TCP握手是建立TCP连接的过程，它发生在任何数据（包括TLS握手）被发送之前。TCP握手确保两个端点（客户端和服务器）之间建立了一个可靠的会话。

TCP握手的步骤如下：

1. **SYN**：客户端发送一个SYN（同步序列编号）包到服务器，以开始新的连接。
2. **SYN-ACK**：服务器接收到SYN包后，回复一个SYN-ACK（同步-确认）包，以确认连接请求。
3. **ACK**：客户端收到SYN-ACK包后，发送一个ACK（确认）包作为响应，完成握手过程。

完成这三次握手后，TCP连接就建立了，客户端和服务器就可以开始交换数据。

### TLS握手

TLS握手是在已经建立的TCP连接上进行的，它的目的是在客户端和服务器之间安全地协商加密参数，以便它们可以开始安全地传输数据。

TLS握手的步骤如下：

1. **ClientHello**：客户端发送一个ClientHello消息，它包含客户端支持的TLS版本、加密套件列表和其他TLS选项。
2. **ServerHello**：服务器回复一个ServerHello消息，选择一个客户端也支持的加密套件和TLS版本，并提供服务器的数字证书。
3. **证书验证**：客户端验证服务器的证书（和证书链，如果适用）。
4. **密钥交换**：客户端和服务器协商生成一个共享的会话密钥，用于加密后续的通信。这可能涉及到客户端发送一个预主密钥，服务器使用其私钥解密。
5. **Finished**：客户端和服务器发送Finished消息，这些消息是使用协商的密钥加密的，以确保握手没有被篡改，并且密钥正确。

完成TLS握手后，客户端和服务器就可以开始使用协商的密钥安全地传输加密数据了。

### 总结

总的来说，TCP握手首先建立一个可靠的连接，然后TLS握手在这个可靠的连接上建立一个安全的通道。这两个握手过程是顺序进行的，都是为了确保数据传输的可靠性和安全性。
